<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="css/sty˝le.css">
  <meta charset="utf-8">
  <title>三國殺牌庫模板</title>
</head>
<body>
  <h1>三國殺牌庫測試</h1>

  <button id="createRoomBtn" class="sgs-btn">建立房間</button>

  <div id="card-area"></div>
  <div id="general-area"></div>



  <script type="module">
    document.addEventListener("contextmenu", e => e.preventDefault());
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

    // 1️⃣ 初始化 Firebase
    const firebaseConfig = {
  apiKey: "AIzaSyDk9Drn-ZkLoKj6HjC6H2eSOYhI_A_pOM4",
  authDomain: "sgs-mvp.firebaseapp.com",
  databaseURL: "https://sgs-mvp-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "sgs-mvp",
  storageBucket: "sgs-mvp.firebasestorage.app",
  messagingSenderId: "749326209652",
  appId: "1:749326209652:web:5dbd03935ea60edb927721"
};

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // 2️⃣ 建立牌庫陣列


    const deck = [
       {
        id: "spade_shandian",
        name: "閃電",
        type: "錦囊牌",
        subtype: "延時類",
        effect: "出牌阶段，对你使用。将【闪电】置入你的判定区。若判定结果为♠2-9，则目标角色受到3点雷电伤害。若判定不为此结果，将之置入其下家的判定区",
        suit: "♠",
        rank: "A",
        extra: {
          delayed: true,
          judgeRange: "♠2-9",
          damage: 3,
          damageType: "雷電"
        },
      },
      { id: "spade_juedou", 
        name: "決鬥", 
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对一名其他角色使用。由该角色开始，你与其轮流打出一张【杀】，然后首先未打出【杀】的角色受到另一名角色造成的1点伤害", 
        suit: "♠", 
        rank: "A", 
        extra: {
          duel: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "gudingdao", 
        name: "古錠刀", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "锁定技，当你使用【杀】对目标角色造成伤害时，若该角色没有手牌，则此伤害+1", 
        suit: "♠", 
        rank: "A", 
        extra: 
        {
          locked: true,
          range: 2,
          bonusDamageIfTargetNoHand: 1      
        },
      },
      { id: "spade_baguazhen", 
        name: "八卦陣", 
        type: "裝備牌", 
        subtype: "防具牌",
        effect: "当你需要使用或打出【闪】时，你可以进行判定。若判定结果为红色，则你视为使用或打出一张【闪】", 
        suit: "♠", 
        rank: "2", 
        extra: 
        {
            locked: false,
            enableJudgement: true,
            judgeRange: "♥♦"
        },
      },
      { id: "cixiongshuanggujian",  
        name: "雌雄雙股劍", 
        type: "裝備牌", 
        subtype: "武器牌",
        effect: "当你使用【杀】指定与你性别不同的一个目标后，你可以令其选择一项：1. 弃置一张手牌；2. 令你摸一张牌", 
        suit: "♠", 
        rank: "2", 
        extra: 
        {
            locked: false,
            targetIsOppositeGender: true,
            optionalEffect: true
        },
      },
      { id: "hanbingjian", 
        name: "寒冰劍", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "当你使用【杀】对目标角色造成伤害时，若该角色有牌，则你可以防止此伤害，然后你依次弃置其两张牌。", 
        suit: "♠", 
        rank: "2",
        
        extra: 
        {
          locked: false,
          range: 2,
          canPreventDamage: true,
          discardTwoIfPrevent: true
        },
      },
      { id: "spade_tengjia", 
        name: "藤甲", 
        type: "裝備牌", 
        subtype: "防具牌",
        effect: "锁定技，【南蛮入侵】、【万箭齐发】和普通【杀】对你无效；当你受到火焰伤害时，此伤害+1", 
        suit: "♠", 
        rank: "2", 
        extra: 
        {
          locked: true,
          immuneNormalSha: true,
          immuneNanman: true,
          immuneWanjian: true,
          fireDamageIncrease: 1      
        },
      },
      { id: "spade3_guohechaiqiao", 
        name: "過河拆橋", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名区域里有牌的其他角色使用。你弃置其区域里的一张牌", 
        suit: "♠", 
        rank: "3", 
        extra: 
        {
          distanceLimit: false,
          discardOneCard: true    
        },
      },
      { id: "spade3_shunshouqianyang", 
        name: "順手牽羊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对距离为1的一名区域里有牌的其他角色使用。你获得其区域里的一张牌", 
        suit: "♠", 
        rank: "3", 
        extra: 
        {
          distanceLimit: 1,
          stealOneCard: true   
        },
      },
      { id: "spade3_jiu", 
        name: "酒", 
        type: "基本牌", 
        effect: "出牌阶段令你本回合使用的下一张【杀】伤害+1或令处于濒死状态的你回復1点体力", 
        suit: "♠", 
        rank: "3", 
        extra: 
        {
          shaDamagePlus: 1,
          healWhenPreDie: 1

        },
      },
      { id: "spade4_guohechaiqiao", 
        name: "過河拆橋", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名区域里有牌的其他角色使用。你弃置其区域里的一张牌", 
        suit: "♠", 
        rank: "4", 
        extra: 
        {
          distanceLimit: false,
          discardOneCard: true    
        },
      },
      { id: "spade4_shunshouqianyang", 
        name: "順手牽羊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对距离为1的一名区域里有牌的其他角色使用。你获得其区域里的一张牌", 
        suit: "♠", 
        rank: "4", 
        extra: 
        {
          distanceLimit: 1,
          stealOneCard: true     
        },
      },
      { id: "spade4_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♠", 
        rank: "4", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "qinglongyanyuedao", 
        name: "青龍偃月刀", 
        type: "裝備牌", 
        subtype: "武器牌",
        effect: "当你使用的【杀】被目标角色使用的【闪】抵消后，你可以再次对其使用一张【杀】", 
        suit: "♠", 
        rank: "5", 

        extra: 
        {
          locked: false, 
          range: 3,
          repeatShaOnDodge: true
        },
      },
      { id: "jueying", 
        name: "絕影", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "+1坐騎",
        effect: "锁定技，其他角色计算与你的距离+1", 
        suit: "♠", 
        rank: "5", 
        extra: 
        {
          locked: true,
          othersToMeDistanceLimitPlus: 1
        },
      },
      { id: "spade5_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♠", 
        rank: "5", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "spade_lebusishu", 
        name: "樂不思蜀", 
        type: "錦囊牌", 
        subtype: "延時類",
        effect: "出牌阶段，对一名其他角色使用。将【乐不思蜀】置入该角色的判定区，若判定结果不为♥，则其跳过出牌阶段", 
        suit: "♠", 
        rank: "6", 
        extra: 
        {
          delayed: true,
          distanceLimit: false,
          skipPlayIfNotHeart: true,
          judgeRange: "♥"
        },
      },
      { id: "qinggangjian", 
        name: "青釭劍", 
        type: "裝備牌", 
        subtype: "武器牌",
        effect: "锁定技，当你使用【杀】指定一个目标后，你令其防具无效", 
        suit: "♠", 
        rank: "6", 
        
        extra: 
        {
          locked: true, 
          range: 2,
          ignoreTargetArmor: true
        },
      },
      { id: "spade6_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♠", 
        rank: "6", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "spade7_nanmanruqin", 
        name: "南蠻入侵", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对所有其他角色使用。每名目标角色需打出一张【杀】，否则受到你造成的1点伤害", 
        suit: "♠", 
        rank: "7", 
        extra: 
        {
          targetsAllOthers: true,
          mustPlayShaOrTakeDamage: true,
          damage: 1,
          damageType: "普通"
        },
      },
      
      { id: "spade7_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "7", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "spade7_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♠", 
        rank: "7", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "spade8_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "spade8_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
       { id: "spade8_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♠", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "spade9_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "9",
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "spade9_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "9", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "spade9_jiu", 
        name: "酒", 
        type: "基本牌", 
        effect: "出牌阶段令你本回合使用的下一张【杀】伤害+1或令处于濒死状态的你回復1点体力", 
        suit: "♠", 
        rank: "9", 
        extra: 
        {
          shaDamagePlus: 1,
          healWhenPreDie: 1
        
        },
      },
      { id: "spade10_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "spade10_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♠", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
       { id: "spade_bingliangcunduan", 
        name: "兵糧寸斷", 
        type: "錦囊牌", 
        subtype: "延時類",
        effect: "出牌阶段，对距离为1的一名其他角色使用。将【兵粮寸断】置入该角色的判定区，若判定结果不为♣，则其跳过摸牌阶段", 
        suit: "♠", 
        rank: "10", 
        extra: 
        {
          delayed: true,
          distanceLimit: 1,
          skipDrawIfNotClub: true,
          judgeRange: "♣"
        },
      },
      { id: "spadeJ_wuxiekeji", 
        name: "無懈可擊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "当一张锦囊牌对一名角色生效前或一张【无懈可击】生效前，对此牌使用。抵消此牌对该角色或该【无懈可击】的效果", 
        suit: "♠", 
        rank: "J", 
        extra: 
        {
          canNegateTrick: true
        },
      },
      { id: "spadeJ_shunshouqianyang", 
        name: "順手牽羊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对距离为1的一名区域里有牌的其他角色使用。你获得其区域里的一张牌", 
        suit: "♠", 
        rank: "J", 
        extra: 
        {
          distanceLimit: 1,
          stealOneCard: true    
        },
      },
      { id: "spadeJ_tiesuolianhuan", 
        name: "鐵索連環", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一至两名角色使用。目标角色横置或重置。（被横置的角色处于「连环状态」）重铸：出牌阶段，你可以将此牌置入弃牌堆，然后摸一张牌", 
        suit: "♠", 
        rank: "J", 
        extra: 
        {
          selectOneOrTwoTargets: true,
          linkedState: true, 
          recast: true,
          drawAfterRecast: true
        },
      },
      { id: "zhangbashemao", 
        name: "丈八蛇矛", 
        type: "裝備牌", 
        subtype: "武器牌",
        effect: "你可以将两张手牌当【杀】使用或打出", 
        suit: "♠", 
        rank: "Q", 
        extra: 
        {
          locked: false,
          range: 3,
          canUseTwoCardsAsSha: true
        },
      },
      { id: "spadeQ_guohechaiqiao", 
        name: "過河拆橋", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名区域里有牌的其他角色使用。你弃置其区域里的一张牌", 
        suit: "♠", 
        rank: "Q", 
        extra: 
        {
          distanceLimit: false,
          discardOneCard: true   
        },
      },
      { id: "spadeQ_tiesuolianhuan", 
        name: "鐵索連環", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一至两名角色使用。目标角色横置或重置。（被横置的角色处于「连环状态」）重铸：出牌阶段，你可以将此牌置入弃牌堆，然后摸一张牌", 
        suit: "♠", 
        rank: "Q", 
        extra: 
        {
          selectOneOrTwoTargets: true,
          linkedState: true, 
          recast: true,
          drawAfterRecast: true
        },
      },
      { id: "dawan", 
        name: "大宛", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "-1坐騎",
        effect: "锁定技，其他角色计算与你的距离-1", 
        suit: "♠", 
        rank: "K", 
        extra: 
        {
          locked: true,
          toOthersDistanceLimit: -1
        },
      },
      { id: "spadeK_nanmanruqin", 
        name: "南蠻入侵", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对所有其他角色使用。每名目标角色需打出一张【杀】，否则受到你造成的1点伤害", 
        suit: "♠", 
        rank: "K", 
        extra: 
        {
          targetsAllOthers: true,
          mustPlayShaOrTakeDamage: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "spadeK_wuxiekeji", 
        name: "無懈可擊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "当一张锦囊牌对一名角色生效前或一张【无懈可击】生效前，对此牌使用。抵消此牌对该角色或该【无懈可击】的效果", 
        suit: "♠", 
        rank: "K", 
        extra: 
        {
          canNegateTrick: true
        },
      },

      {
        id: "heartA_taoyuanjieyi",
        name: "桃園結義",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对所有角色使用。每名目标角色回復1点体力",
        suit: "♥",
        rank: "A",
        extra: {
          healAll: 1
        }
      },
      {
        id: "heartA_wanjianqifa",
        name: "萬箭齊發",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对所有其他角色使用。每名目标角色需打出一张【闪】，否则受到你造成的1点伤害",
        suit: "♥",
        rank: "A",
        extra: {
          targetsAllOthers: true,
          mustPlayShanOrTakeDamage: true,
          damage: 1,
          damageType: "普通"
        }
      },
      { id: "heartA_wuxiekeji", 
        name: "無懈可擊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "当一张锦囊牌对一名角色生效前或一张【无懈可击】生效前，对此牌使用。抵消此牌对该角色或该【无懈可击】的效果", 
        suit: "♥", 
        rank: "A", 
        extra: 
        {
          canNegateTrick: true
        },
      },
      { id: "heart2_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "2", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "heart2_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "2", 
        extra: 
        {
          dodgeSha: true
        },
      },
      {
        id: "heart2_huogong",
        name: "火攻",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对一名有手牌的角色使用。该角色展示一张手牌，然后若你弃置与之花色相同的一张手牌，则你对其造成1点火焰伤害",
        suit: "♥",
        rank: "2",
        extra: {
          mustHaveHandCard: true,
          showCard: true,            
          discardSameColor: true,     
          damage: 1,                 
          damageType: "火焰"     
        }
      },
      {
        id: "heart3_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "3",
        extra: {
          heal: 1 
        }
      },
      {
        id: "heart3_wugufengdeng",
        name: "五穀豐登",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对所有角色使用。你亮出牌堆顶等同于目标角色数的牌。每名目标角色获得其中的一张",
        suit: "♥",
        rank: "3",
        extra: {
          targetsAll: true,
          revealCards: true,
          chooseFromRevealed: true
        }
      },
      {
        id: "heart3_huogong",
        name: "火攻",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对一名有手牌的角色使用。该角色展示一张手牌，然后若你弃置与之花色相同的一张手牌，则你对其造成1点火焰伤害",
        suit: "♥",
        rank: "3",
        extra: {
          mustHaveHandCard: true,
          showCard: true,            
          discardSameColor: true,     
          damage: 1,                 
          damageType: "火焰"     
        }
      },
      {
        id: "heart4_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "4",
        extra: {
          heal: 1
        }
      },
      {
        id: "heart4_wugufengdeng",
        name: "五穀豐登",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对所有角色使用。你亮出牌堆顶等同于目标角色数的牌。每名目标角色获得其中的一张",
        suit: "♥",
        rank: "4",
        extra: {
          targetsAll: true,
          revealCards: true,
          chooseFromRevealed: true
        }
      },
      { id: "heart4_huosha", 
        name: "火【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点火焰伤害", 
        suit: "♥", 
        rank: "4", 
        extra: 
        {
          damage: 1,
          damageType: "火焰"
        },
      },
      { id: "qilingong", 
        name: "麒麟弓", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "当你使用【杀】对目标角色造成伤害时，你可以弃置其装备区里的一张坐骑牌", 
        suit: "♥", 
        rank: "5", 
        extra: 
        {
          locked: false,
          range: 5,
          discardTargetMount: true
        },
      },
      { id: "chitu", 
        name: "赤兔", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "-1坐騎",
        effect: "锁定技，其他角色计算与你的距离-1", 
        suit: "♥", 
        rank: "5", 
        extra: 
        {
          locked: true,
          toOthersDistanceLimit: -1 
        },
      },
      {
        id: "heart5_tao_1",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "5",
        extra: {
          heal: 1    
        }
      },
      {
        id: "heart6_tao_1",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "6",
        extra: {
          heal: 1   
        }
      },
      { id: "heart_lebusishu", 
        name: "樂不思蜀", 
        type: "錦囊牌", 
        subtype: "延時類",
        effect: "出牌阶段，对一名其他角色使用。将【乐不思蜀】置入该角色的判定区，若判定结果不为♥，则其跳过出牌阶段", 
        suit: "♥", 
        rank: "6", 
        extra: 
        {
          delayed: true,
          distanceLimit: false,
          skipPlayIfNotHeart: true,
          judgeRange: "♥"
        },
      },
      {
        id: "heart6_tao_2",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "6",
        extra: {
          heal: 1    
        }
      },
      {
        id: "heart7_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "7",
        extra: {
          heal: 1   
        }
      },
      {
        id: "heart7_wuzhongshengyou",
        name: "無中生有",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对你使用。你摸两张牌",
        suit: "♥",
        rank: "7",
        extra: {
          drawCards: 2  
        }
      },
      { id: "heart7_huosha", 
        name: "火【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点火焰伤害", 
        suit: "♥", 
        rank: "7", 
        extra: 
        {
          damage: 1,
          damageType: "火焰"
        },
      },
      {
        id: "heart8_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "8",
        extra: {
          heal: 1   
        }
      },
      {
        id: "heart8_wuzhongshengyou",
        name: "無中生有",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对你使用。你摸两张牌",
        suit: "♥",
        rank: "8",
        extra: {
          drawCards: 2  
        }
      },
      { id: "heart8_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "8", 
        extra: 
        {
          dodgeSha: true
        },
      },
      {
        id: "heart9_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "9",
        extra: {
          heal: 1  
        }
      },
      {
        id: "heart9_wuzhongshengyou",
        name: "無中生有",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对你使用。你摸两张牌",
        suit: "♥",
        rank: "9",
        extra: {
          drawCards: 2   
        }
      },
      { id: "heart9_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "9", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "heart10_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♥", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "heart10_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♥", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "heart10_huosha", 
        name: "火【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点火焰伤害", 
        suit: "♥", 
        rank: "10", 
        extra: 
        {
          damage: 1,
          damageType: "火焰"
        },
      },
      { id: "heartJ_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♥", 
        rank: "J", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      {
        id: "heartJ_wuzhongshengyou",
        name: "無中生有",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对你使用。你摸两张牌",
        suit: "♥",
        rank: "J",
        extra: {
          drawCards: 2
        }
      },
      { id: "heartJ_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "J", 
        extra: 
        {
          dodgeSha: true
        },
      },
      {
        id: "heartQ_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♥",
        rank: "Q",
        extra: {
          heal: 1    
        }
      },
      { id: "heartQ_guohechaiqiao", 
        name: "過河拆橋", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名区域里有牌的其他角色使用。你弃置其区域里的一张牌", 
        suit: "♥", 
        rank: "Q", 
        extra: 
        {
          distanceLimit: false,
          discardOneCard: true 
        },
      },
      {
        id: "heart_shandian",
        name: "閃電",
        type: "錦囊牌",
        subtype: "延時類",
        effect: "出牌阶段，对你使用。将【闪电】置入你的判定区。若判定结果为♠2-9，则目标角色受到3点雷电伤害。若判定不为此结果，将之置入其下家的判定区",
        suit: "♥",
        rank: "Q",
        extra: {
          delayed: true,
          judgeRange: "♠2-9",
          damage: 3,
          damageType: "雷電"
        },
      },
      { id: "heartQ_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "Q", 
        extra: 
        {
          dodgeSha: true
        },
      },
       { id: "zhuahuangfeidian", 
        name: "爪黃飛電", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "+1坐騎",
        effect: "锁定技，其他角色计算与你的距离+1", 
        suit: "♥", 
        rank: "K", 
        extra: 
        {
          locked: true,
          othersToMeDistanceLimitPlus: 1
        },
      },
      { id: "heartK_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♥", 
        rank: "K", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "heartK_wuxiekeji", 
        name: "無懈可擊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "当一张锦囊牌对一名角色生效前或一张【无懈可击】生效前，对此牌使用。抵消此牌对该角色或该【无懈可击】的效果", 
        suit: "♥", 
        rank: "K", 
        extra: 
        {
          canNegateTrick: true
        },
      },
      { id: "club_zhugeliannu", 
        name: "諸葛連弩", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "锁定技，你使用【杀】无次数限制", 
        suit: "♣", 
        rank: "A", 
        extra: 
        {
          locked: true,
          range: 1,
          canUseUnlimitedSha: true
        },
      },
      { id: "club_juedou", 
        name: "決鬥", 
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对一名其他角色使用。由该角色开始，你与其轮流打出一张【杀】，然后首先未打出【杀】的角色受到另一名角色造成的1点伤害", 
        suit: "♣", 
        rank: "A", 
        extra: {
          duel: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "baiyinshizi", 
        name: "白銀獅子", 
        type: "裝備牌", 
        subtype: "防具牌",
        effect: "锁定技，当你受到伤害时，若伤害值大于1，则你将伤害值改为1；当你失去装备区里的【白银狮子】后，你回復1点体力", 
        suit: "♣", 
        rank: "A", 
        extra: 
        {
            locked: true,
            limitDamageToOne: true,
            healOnUnquip: 1
        },
      },
      { id: "club_baguazhen", 
        name: "八卦陣", 
        type: "裝備牌", 
        subtype: "防具牌",
        effect: "当你需要使用或打出【闪】时，你可以进行判定。若判定结果为红色，则你视为使用或打出一张【闪】", 
        suit: "♣", 
        rank: "2", 
        extra: 
        {
            locked: false,
            enableJudgement: true,
            judgeRange: "♥♦"
        },
      },
      { id: "club2_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "2", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
       { id: "renwangdun", 
        name: "仁王盾", 
        type: "裝備牌", 
        subtype: "防具牌",
        effect: "锁定技，黑色的【杀】对你无效", 
        suit: "♣", 
        rank: "2", 
        extra: 
        {
            locked: true,
            immuneBlackSha: true
        },
      },
      { id: "club_tengjia", 
        name: "藤甲", 
        type: "裝備牌", 
        subtype: "防具牌",
        effect: "锁定技，【南蛮入侵】、【万箭齐发】和普通【杀】对你无效；当你受到火焰伤害时，此伤害+1", 
        suit: "♣", 
        rank: "2", 
        extra: 
        {
          locked: true,
          immuneNormalSha: true,
          immuneNanman: true,
          immuneWanjian: true,
          fireDamageIncrease: 1      
        },
      },
      { id: "club3_guohechaiqiao", 
        name: "過河拆橋", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名区域里有牌的其他角色使用。你弃置其区域里的一张牌", 
        suit: "♣", 
        rank: "3", 
        extra: 
        {
          distanceLimit: false,
          discardOneCard: true    
        },
      },
      { id: "club3_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "3", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club3_jiu", 
        name: "酒", 
        type: "基本牌", 
        effect: "出牌阶段令你本回合使用的下一张【杀】伤害+1或令处于濒死状态的你回復1点体力", 
        suit: "♣", 
        rank: "3", 
        extra: 
        {
          shaDamagePlus: 1,
          healWhenPreDie: 1

        },
      },
      { id: "club4_guohechaiqiao", 
        name: "過河拆橋", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名区域里有牌的其他角色使用。你弃置其区域里的一张牌", 
        suit: "♣", 
        rank: "4", 
        extra: 
        {
          distanceLimit: false,
          discardOneCard: true  
        },
      },
      { id: "club4_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "4", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club_bingliangcunduan", 
        name: "兵糧寸斷", 
        type: "錦囊牌", 
        subtype: "延時類",
        effect: "出牌阶段，对距离为1的一名其他角色使用。将【兵粮寸断】置入该角色的判定区，若判定结果不为♣，则其跳过摸牌阶段", 
        suit: "♣", 
        rank: "4", 
        extra: 
        {
          delayed: true,
          distanceLimit: 1,
          skipDrawIfNotClub: true,
          judgeRange: "♣"
        },
      },
      { id: "dilu", 
        name: "的盧", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "+1坐騎",
        effect: "锁定技，其他角色计算与你的距离+1", 
        suit: "♣", 
        rank: "5", 
        extra: 
        {
          locked: true,
          othersToMeDistanceLimitPlus: 1
        },
      },
      { id: "club5_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "5", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club5_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♣", 
        rank: "5", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "club_lebusishu", 
        name: "樂不思蜀", 
        type: "錦囊牌", 
        subtype: "延時類",
        effect: "出牌阶段，对一名其他角色使用。将【乐不思蜀】置入该角色的判定区，若判定结果不为♥，则其跳过出牌阶段", 
        suit: "♣", 
        rank: "6", 
        extra: 
        {
          delayed: true,
          distanceLimit: false,
          skipPlayIfNotHeart: true,
          judgeRange: "♥"
        },
      },
      { id: "club6_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "6", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club6_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♣", 
        rank: "6", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "club7_nanmanruqin", 
        name: "南蠻入侵", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌階段，對所有其他角色使用。每名目標角色需打出一張【殺】，否則受到你造成的1點傷害", 
        suit: "♣", 
        rank: "7", 
        extra: 
        {
          targetsAllOthers: true,
          mustPlayShaOrTakeDamage: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club7_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "7", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club7_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♣", 
        rank: "7", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
      { id: "club8_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club8_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
       { id: "club8_leisha", 
        name: "雷【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点雷电伤害", 
        suit: "♣", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "雷電"
        },
      },
       { id: "club9_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "9", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club9_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "9", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club9_jiu", 
        name: "酒", 
        type: "基本牌", 
        effect: "出牌阶段令你本回合使用的下一张【杀】伤害+1或令处于濒死状态的你回復1点体力", 
        suit: "♣", 
        rank: "9", 
        extra: 
        {
          shaDamagePlus: 1,
          healWhenPreDie: 1

        },
      },
       { id: "club10_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club10_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "club10_tiesuolianhuan", 
        name: "鐵索連環", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一至两名角色使用。目标角色横置或重置。（被横置的角色处于「连环状态」）重铸：出牌阶段，你可以将此牌置入弃牌堆，然后摸一张牌", 
        suit: "♣", 
        rank: "10", 
        extra: 
        {
          selectOneOrTwoTargets: true,
          linkedState: true, 
          recast: true,
          drawAfterRecast: true
        },
      },
      { id: "clubJ_sha_1", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "J", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "clubJ_sha_2", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♣", 
        rank: "J", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "clubJ_tiesuolianhuan", 
        name: "鐵索連環", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一至两名角色使用。目标角色横置或重置。（被横置的角色处于「连环状态」）重铸：出牌阶段，你可以将此牌置入弃牌堆，然后摸一张牌", 
        suit: "♣", 
        rank: "J", 
        extra: 
        {
          selectOneOrTwoTargets: true,
          linkedState: true, 
          recast: true,
          drawAfterRecast: true
        },
      },
      { id: "clubQ_jiedaosharen", 
        name: "借刀殺人", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名装备区里有武器牌的其他角色使用。除非该角色对其攻击范围内，由你选择的另一名角色使用一张【杀】，否则将其装备区里的武器牌交给你", 
        suit: "♣", 
        rank: "Q", 
        extra: 
        {
         targetMustHaveWeapon: true,
         mustShaOrLoseWeapon: true
        },
      },
      { id: "clubQ_wuxiekeji", 
        name: "無懈可擊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "当一张锦囊牌对一名角色生效前或一张【无懈可击】生效前，对此牌使用。抵消此牌对该角色或该【无懈可击】的效果", 
        suit: "♣", 
        rank: "Q", 
        extra: 
        {
          canNegateTrick: true
        },
      },
      { id: "clubQ_tiesuolianhuan", 
        name: "鐵索連環", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一至两名角色使用。目标角色横置或重置。（被横置的角色处于「连环状态」）重铸：出牌阶段，你可以将此牌置入弃牌堆，然后摸一张牌", 
        suit: "♣", 
        rank: "Q", 
        extra: 
        {
          selectOneOrTwoTargets: true,
          linkedState: true, 
          recast: true,
          drawAfterRecast: true
        },
      },
      { id: "clubK_jiedaosharen", 
        name: "借刀殺人", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一名装备区里有武器牌的其他角色使用。除非该角色对其攻击范围内，由你选择的另一名角色使用一张【杀】，否则将其装备区里的武器牌交给你", 
        suit: "♣", 
        rank: "K", 
        extra: 
        {
         targetMustHaveWeapon: true,
         mustShaOrLoseWeapon: true
        },
      },
      { id: "clubK_wuxiekeji", 
        name: "無懈可擊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "当一张锦囊牌对一名角色生效前或一张【无懈可击】生效前，对此牌使用。抵消此牌对该角色或该【无懈可击】的效果", 
        suit: "♣", 
        rank: "K", 
        extra: 
        {
          canNegateTrick: true
        },
      },
      { id: "clubK_tiesuolianhuan", 
        name: "鐵索連環", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对一至两名角色使用。目标角色横置或重置。（被横置的角色处于「连环状态」）重铸：出牌阶段，你可以将此牌置入弃牌堆，然后摸一张牌", 
        suit: "♣", 
        rank: "K", 
        extra: 
        {
          selectOneOrTwoTargets: true,
          linkedState: true, 
          recast: true,
          drawAfterRecast: true
        },
      },
      { id: "diamond_zhugeliannu", 
        name: "諸葛連弩", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "锁定技，你使用【杀】无次数限制", 
        suit: "♦", 
        rank: "A", 
        extra: 
        {
          locked: true,
          range: 1,
          canUseUnlimitedSha: true
        },
      },
      { id: "diamond_juedou", 
        name: "決鬥", 
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对一名其他角色使用。由该角色开始，你与其轮流打出一张【杀】，然后首先未打出【杀】的角色受到另一名角色造成的1点伤害", 
        suit: "♦", 
        rank: "A", 
        extra: {
          duel: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "zhuqueyushan", 
        name: "朱雀羽扇", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "当你使用普通【杀】时，你可以将此【杀】改为火【杀】", 
        suit: "♦", 
        rank: "A", 
        extra: 
        {
          locked: false,
          range: 4,
          convertNormalShaToFireSha: true
        },
      },
      { id: "diamond2_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "2", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond2_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "2", 
        extra: 
        {
          dodgeSha: true
        },
      },
      {
        id: "diamond2_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♦",
        rank: "2",
        extra: {
          heal: 1    
        }
      },
      { id: "diamond3_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "3", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond3_shunshouqianyang", 
        name: "順手牽羊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对距离为1的一名区域里有牌的其他角色使用。你获得其区域里的一张牌", 
        suit: "♦", 
        rank: "3", 
        extra: 
        {
          distanceLimit: 1,
          stealOneCard: true   
        },
      },
      {
        id: "diamond3_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♦",
        rank: "3",
        extra: {
          heal: 1    
        }
      },
      { id: "diamond4_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "4", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond4_shunshouqianyang", 
        name: "順手牽羊", 
        type: "錦囊牌", 
        subtype: "普通類",
        effect: "出牌阶段，对距离为1的一名区域里有牌的其他角色使用。你获得其区域里的一张牌", 
        suit: "♦", 
        rank: "4", 
        extra: 
        {
          distanceLimit: 1,
          stealOneCard: true   
        },
      },
      { id: "diamond4_huosha", 
        name: "火【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点火焰伤害", 
        suit: "♦", 
        rank: "4", 
        extra: 
        {
          damage: 1,
          damageType: "火焰"
        },
      },
      { id: "diamond5_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "5", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "guanshifu", 
        name: "貫石斧", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "当你使用的【杀】被目标角色使用的【闪】抵消后，你可以弃置两张牌。若如此做，此【杀】依然会造成伤害", 
        suit: "♦", 
        rank: "5", 
        extra: 
        {
          locked: false,
          range: 3,
          discardTwoWhenShaNegated: true
        },
      },
      { id: "diamond5_huosha", 
        name: "火【殺】", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点火焰伤害", 
        suit: "♦", 
        rank: "5", 
        extra: 
        {
          damage: 1,
          damageType: "火焰"
        },
      },
      { id: "diamond6_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "6", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond6_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♦", 
        rank: "6", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "diamond6_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "6", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond7_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "7", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond7_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♦", 
        rank: "7", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "diamond7_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "7", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond8_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "8", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond8_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♦", 
        rank: "8", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "diamond8_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "8", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond9_shan", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "9", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond9_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♦", 
        rank: "9", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "diamond9_jiu", 
        name: "酒", 
        type: "基本牌", 
        effect: "出牌阶段令你本回合使用的下一张【杀】伤害+1或令处于濒死状态的你回復1点体力", 
        suit: "♦", 
        rank: "9", 
        extra: 
        {
          shaDamagePlus: 1,
          healWhenPreDie: 1

        },
      },
      { id: "diamond10_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "10", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamond10_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♦", 
        rank: "10", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
      { id: "diamond10_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "10", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamondJ_shan_1", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "J", 
        extra: 
        {
          dodgeSha: true
        },
      },
      { id: "diamondJ_shan_2", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "J", 
        extra: 
        {
          dodgeSha: true
        },
      },
       { id: "diamondJ_shan_3", 
        name: "閃", 
        type: "基本牌", 
        effect: "当你成为杀的目标时，使用此牌可抵消【杀】的效果", 
        suit: "♦", 
        rank: "J", 
        extra: 
        {
          dodgeSha: true
        },
      },
      {
        id: "diamondQ_tao",
        name: "桃",
        type: "基本牌",
        effect: "出牌阶段回復已受伤的你1点体力或令一名处于濒死状态的角色回復1点体力",
        suit: "♦",
        rank: "Q",
        extra: {
          heal: 1   
        }
      },
      { id: "fangtianhuaji", 
        name: "方天畫戟", 
        type: "裝備牌",
        subtype: "武器牌", 
        effect: "锁定技，若你使用【杀】是你最后的手牌，则此【杀】可以多选择两个目标", 
        suit: "♦", 
        rank: "Q", 
        extra: 
        {
          locked: true,
          range: 4,
          maxExtraTargetsWhenShaIsOnlyHand: 2
        },
      },
       {
        id: "diamondQ_huogong",
        name: "火攻",
        type: "錦囊牌",
        subtype: "普通類",
        effect: "出牌阶段，对一名有手牌的角色使用。该角色展示一张手牌，然后若你弃置与之花色相同的一张手牌，则你对其造成1点火焰伤害",
        suit: "♦",
        rank: "Q",
        extra: {
          mustHaveHandCard: true,
          showCard: true,            
          discardSameColor: true,     
          damage: 1,                 
          damageType: "火焰"     
        }
      },
      { id: "diamondK_sha", 
        name: "殺", 
        type: "基本牌", 
        effect: "出牌阶段，对你攻击范围内的一名其他角色使用，你对该角色造成1点伤害", 
        suit: "♦", 
        rank: "K", 
        extra: 
        {
          attackDistanceLimit: true,
          damage: 1,
          damageType: "普通"
        },
      },
       { id: "zixing", 
        name: "紫騂", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "-1坐騎",
        effect: "锁定技，其他角色计算与你的距离-1", 
        suit: "♦", 
        rank: "K", 
        extra: 
        {
          locked: true,
          toOthersDistanceLimit: -1
        },
      },
      { id: "hualiu", 
        name: "驊騮", 
        type: "裝備牌", 
        subtype: "坐騎牌",
        subsubtype: "+1坐騎",
        effect: "锁定技，其他角色计算与你的距离+1", 
        suit: "♦", 
        rank: "K", 
        extra: 
        {
          locked: true,
          othersToMeDistanceLimitPlus: 1
        },
      },
      



      








      
    
    ];

    // 🟩🟩🟩 在這裡放 generals 陣列（武將資料） 🟩🟩🟩

    const generals = [
      {
        id: "liubei",
        name: "劉備",
        kingdom: "蜀",
        maxHp: 4,
        gender: "male",
        version: "standard",
        edition: "",
        skills: [
          {
            name: "仁德",
            description: "出牌阶段限一次，你可以将任意数量的手牌交给其他角色，若你给出的牌张数达到两张或更多时，你回復1点体力。"
          },
          {
            name: "激将",
            description: "主公技，当你需要使用或打出一张【杀】时，你可以令其他蜀势力角色打出一张【杀】（视为由你使用或打出）。"
         }
        ]
      },
      {
        id: "guanyu",
        name: "關羽",
        kingdom: "蜀",
        maxHp: 4,
        gender: "male",
        version: "standard",
        edition: "",
        skills: [
          {
            name: "武聖",
            description: "你可以将一张红色牌当【杀】使用或打出。"
          }
        ]
      },
      {
        id: "zhangfei",
        name: "張飛",
        kingdom: "蜀",
        maxHp: 4,
        gender: "male",
        version: "standard",
        edition: "",
        skills: [
          {
            name: "咆哮",
            description: "锁定技，你使用【杀】无次数限制。"
         }
        ]
      },
      {
        id: "zhaoyun",
        name: "趙雲",
        kingdom: "蜀",
        maxHp: 4,
        gender: "male",
        version: "standard",
        edition: "",
        skills: [
          {
            name: "龍膽",
            description: "你可以将【杀】当【闪】，【闪】当【杀】使用或打出。"
          }
         ]
      },
      {
       id: "machao",
       name: "馬超",
       kingdom: "蜀",
       maxHp: 4,
       gender: "male",
       version: "standard",
       edition: "",
       skills: [
         {
           name: "馬術",
           description: "锁定技，你计算与其他角色的距离-1。"
         },
         {
           name: "鐵騎",
           description: "你的【杀】指定目标后，你可以进行判定，若结果为红色，该角色不能使用【闪】。"
         }
       ]
     }
      
 
];
    // 3️⃣ 寫入 Firebase
    deck.forEach(card => {
      set(ref(database, 'deck/' + card.id), card)
        .then(() => console.log(`${card.name} 存入成功 ✅`))
        .catch(err => console.error(`${card.name} 寫入失敗 ❌`, err));
    });
    generals.forEach(g => {
  set(ref(database, "generals/" + g.id), g);
});

    const createRoomBtn = document.getElementById("createRoomBtn");

    createRoomBtn.addEventListener("click", () => {
    const roomId = "room_" + Math.random().toString(36).substring(2, 8);

    const roomRef = ref(database, "rooms/" + roomId);

  set(roomRef, {
    players: {},
    gameState: "waiting",
    deckOrder: [],
    discardPile: []
  }).then(() => {
    console.log("房間建立成功！ID =", roomId);
  });
});

    // 4️⃣ 讀取 Firebase 牌庫
    const deckRef = ref(database, 'deck');
onValue(deckRef, (snapshot) => {
  const deckData = snapshot.val();

  // 🔥🔥🔥：每次重新 render 之前先清空畫面
  document.getElementById("card-area").innerHTML = "";

  // 再把牌庫全部畫出來
  Object.values(deckData).forEach(card => {
    renderCard(card);
  });
});
// === 長按技能顯示 ===
function addGeneralPressEffect(cardElement) {
  const skillBox = cardElement.querySelector(".skill-box");
  let pressTimer = null;

  const showBox = () => {
    skillBox.style.display = "block";
  };
  const hideBox = () => {
    skillBox.style.display = "none";
  };
  const startPress = () => {
    pressTimer = setTimeout(showBox, 300);
  };
  const cancelPress = () => {
    clearTimeout(pressTimer);
    hideBox();
  };

  // 電腦
  cardElement.addEventListener("mousedown", startPress);
  cardElement.addEventListener("mouseup", cancelPress);
  cardElement.addEventListener("mouseleave", cancelPress);

  // 手機
  cardElement.addEventListener("touchstart", startPress);
  cardElement.addEventListener("touchend", cancelPress);
  cardElement.addEventListener("touchcancel", cancelPress);
}
function renderGeneral(g) {

  // 勢力顏色
  const factionColorMap = {
    "蜀": "#b71c1c",
    "魏": "#0d47a1",
    "吳": "#1b5e20",
    "群": "#424242"
  };

  const factionColor = factionColorMap[g.kingdom] || "#555";

  // 圖片位置（標將用 biao{id}.png）
  const imgPath = `sgs-images/heros/generals/biao${g.id}.png`;

 

// ⭐ 展示用武將卡 → 一律滿血
const currHp = g.maxHp;
const maxHp = g.maxHp;

// 顏色依 "剩餘血量"（但滿血 = 全綠）
function getHpColorByCurrent(currHp) {
  if (currHp >= 4) return "#00cc33";   // 綠
  if (currHp === 3) return "#66cc00";  // 黃綠
  if (currHp === 2) return "#ffcc00";  // 黃
  if (currHp === 1) return "#ff0000";  // 紅
  return "#000000";                    // 黑（理論上不會用到）
}

let hpHTML = "";
for (let i = 0; i < maxHp; i++) {
  if (i < currHp) {
    // 剩餘血量統一顏色
    hpHTML += `<div class="hp-dot" style="background:${getHpColorByCurrent(currHp)}"></div>`;
  } else {
    // 超出的都是黑色
    hpHTML += `<div class="hp-dot" style="background:#000000"></div>`;
  }
}

  // 版本（標將不顯示）
  const editionHTML = g.edition
    ? `<div class="general-edition">${g.edition}</div>`
    : "";

  // 技能內容（水平長方形一次顯示）
  const skillText = g.skills
    .map(s => `【${s.name}】${s.description}`)
    .join("<br><br>");

  const html = `
    <div class="general-card">

      <div class="general-side">
        <div class="faction-bar" style="background:${factionColor};">${g.kingdom}</div>
        <div class="general-name-vert">${g.name}</div>

        <div class="hp-area">${hpHTML}</div>
      </div>

      <div class="general-main">
        <img class="general-art" src="${imgPath}">

        <div class="identity-tag">主</div>

        ${editionHTML}

        <div class="hand-count">手牌：4</div>

        <!-- 技能框 -->
        <div class="skill-box">${skillText}</div>
        

      </div>

    </div>
  `;

  const area = document.getElementById("general-area");
  area.insertAdjacentHTML("beforeend", html);

  // ⭐ 長按效果（跟 deck 用法一樣）
  const cardElement = area.lastElementChild;
  addGeneralPressEffect(cardElement);
}





  function renderCard(card) {
  // 1️⃣ 花色顏色（紅心、方塊紅色，其他黑色）
  const suitColor = (card.suit === "♥" || card.suit === "♦") ? "red" : "black";

  // 2️⃣ 依卡片 types 決定資料夾
  let folder = "other";
  if (card.subtype === "武器牌") {
    folder = "weapons";
  } else if (card.subtype === "防具牌") {
    folder = "armors";
  } else if (card.subtype === "坐騎牌") {
    folder = "mounts";
  } else if (card.type === "錦囊牌") {
    folder = "tricks";
  } else if (card.type === "基本牌") {
    folder = "basic";
  }

const imageNameMap = {

  // ====== 武器（weapons/）======
  gudingdao: "gudingdao.png",
  qinglongyanyuedao: "qinglongyanyuedao.png",
  cixiongshuanggujian: "cixiongshuanggujian.png",
  hanbingjian: "hanbingjian.png",
  qinggangjian: "qinggangjian.png",
  zhangbashemao: "zhangbashemao.png",
  guanshifu: "guanshifu.png",
  fangtianhuaji: "fangtianhuaji.png",
  zhuqueyushan: "zhuqueyushan.png",
  qilingong: "qilingong.png",
  club_zhugeliannu: "zhugeliannu.png",
  diamond_zhugeliannu: "zhugeliannu.png",

  // ====== 防具（armors/）======
  spade_baguazhen: "baguazhen.png",
  club_baguazhen: "baguazhen.png",
  baiyinshizi: "baiyinshizi.png",
  renwangdun: "renwangdun.png",
  spade_tengjia: "tengjia.png",
  club_tengjia: "tengjia.png",

  // ====== 坐騎（mounts/）======
  jueying: "jueying.png",
  chitu: "chitu.png",
  dilu: "dilu.png",
  zhuahuangfeidian: "zhuahuangfeidian.png",
  dawan: "dawan.png",
  zixing: "zixing.png",
  hualiu: "hualiu.png",

  // ====== 延時錦囊（tricks/）======
  spade_shandian: "shandian.png",
  heart_shandian: "shandian.png",

  spade_lebusishu: "lebusishu.png",
  heart_lebusishu: "lebusishu.png",
  club_lebusishu: "lebusishu.png",

  spade_bingliangcunduan: "bingliangcunduan.png",
  club_bingliangcunduan: "bingliangcunduan.png",

  // ====== 普通錦囊（tricks/）======
  spade_juedou: "juedou.png",
  club_juedou: "juedou.png",
  diamond_juedou: "juedou.png",

  spade3_guohechaiqiao: "guohechaiqiao.png",
  spade4_guohechaiqiao: "guohechaiqiao.png",
  spadeQ_guohechaiqiao: "guohechaiqiao.png",
  heartQ_guohechaiqiao: "guohechaiqiao.png",
  club3_guohechaiqiao: "guohechaiqiao.png",
  club4_guohechaiqiao: "guohechaiqiao.png",

  spade3_shunshouqianyang: "shunshouqianyang.png",
  spade4_shunshouqianyang: "shunshouqianyang.png",
  spadeJ_shunshouqianyang: "shunshouqianyang.png",
  diamond3_shunshouqianyang: "shunshouqianyang.png",
  diamond4_shunshouqianyang: "shunshouqianyang.png",

  spadeJ_tiesuolianhuan: "tiesuolianhuan.png",
  spadeQ_tiesuolianhuan: "tiesuolianhuan.png",
  club10_tiesuolianhuan: "tiesuolianhuan.png",
  clubJ_tiesuolianhuan: "tiesuolianhuan.png",
  clubQ_tiesuolianhuan: "tiesuolianhuan.png",
  clubK_tiesuolianhuan: "tiesuolianhuan.png",

  spade7_nanmanruqin: "nanmanruqin.png",
  club7_nanmanruqin: "nanmanruqin.png",
  spadeK_nanmanruqin: "nanmanruqin.png",

  heartA_wanjianqifa: "wanjianqifa.png",

  heart7_wuzhongshengyou: "wuzhongshengyou.png",
  heart8_wuzhongshengyou: "wuzhongshengyou.png",
  heart9_wuzhongshengyou: "wuzhongshengyou.png",
  heartJ_wuzhongshengyou: "wuzhongshengyou.png",

  heart3_wugufengdeng: "wugufengdeng.png",
  heart4_wugufengdeng: "wugufengdeng.png",

  heart2_huogong: "huogong.png",
  heart3_huogong: "huogong.png",
  diamondQ_huogong: "huogong.png",

  heartA_taoyuanjieyi: "taoyuanjieyi.png",

  clubQ_jiedaosharen: "jiedaosharen.png",
  clubK_jiedaosharen: "jiedaosharen.png",

  // ====== 無懈可擊 =======
  spadeJ_wuxiekeji: "wuxiekeji.png",
  spadeK_wuxiekeji: "wuxiekeji.png",
  heartA_wuxiekeji: "wuxiekeji.png",
  heartK_wuxiekeji: "wuxiekeji.png",
  clubQ_wuxiekeji: "wuxiekeji.png",
  clubK_wuxiekeji: "wuxiekeji.png",

  // ====== 基本牌：桃（basic/）======
  heart3_tao: "tao.png",
  heart4_tao: "tao.png",
  heart5_tao_1: "tao.png",
  heart6_tao_1: "tao.png",
  heart6_tao_2: "tao.png",
  heart7_tao: "tao.png",
  heart8_tao: "tao.png",
  heart9_tao: "tao.png",
  heartQ_tao: "tao.png",
  diamond2_tao: "tao.png",
  diamond3_tao: "tao.png",
  diamondQ_tao: "tao.png",

  // ====== 基本牌：酒 ======
  spade3_jiu: "jiu.png",
  spade9_jiu: "jiu.png",
  club3_jiu: "jiu.png",
  club9_jiu: "jiu.png",
  diamond9_jiu: "jiu.png",

  // ====== 基本牌：閃 ======
  heart2_shan_1: "shan.png",
  heart2_shan_2: "shan.png",
  heart8_shan: "shan.png",
  heart9_shan: "shan.png",
  heartJ_shan: "shan.png",
  heartQ_shan: "shan.png",
  heartK_shan: "shan.png",

  diamond2_shan_1: "shan.png",
  diamond2_shan_2: "shan.png",
  diamond3_shan: "shan.png",
  diamond4_shan: "shan.png",
  diamond5_shan: "shan.png",
  diamond6_shan_1: "shan.png",
  diamond6_shan_2: "shan.png",
  diamond7_shan_1: "shan.png",
  diamond7_shan_2: "shan.png",
  diamond8_shan_1: "shan.png",
  diamond8_shan_2: "shan.png",
  diamond9_shan: "shan.png",
  diamond10_shan_1: "shan.png",
  diamond10_shan_2: "shan.png",
  diamondJ_shan_1: "shan.png",
  diamondJ_shan_2: "shan.png",
  diamondJ_shan_3: "shan.png",

  // ====== 基本牌：普通殺／火殺／雷殺（全部 sha.png）======
  spade7_sha: "sha.png",
  spade8_sha_1: "sha.png",
  spade8_sha_2: "sha.png",
  spade9_sha_1: "sha.png",
  spade9_sha_2: "sha.png",
  spade10_sha_1: "sha.png",
  spade10_sha_2: "sha.png",

  heart10_sha_1: "sha.png",
  heart10_sha_2: "sha.png",
  heartJ_sha: "sha.png",

  club2_sha: "sha.png",
  club3_sha: "sha.png",
  club4_sha: "sha.png",
  club5_sha: "sha.png",
  club6_sha: "sha.png",
  club7_sha: "sha.png",
  club8_sha_1: "sha.png",
  club8_sha_2: "sha.png",
  club9_sha_1: "sha.png",
  club9_sha_2: "sha.png",
  club10_sha_1: "sha.png",
  club10_sha_2: "sha.png",
  clubJ_sha_1: "sha.png",
  clubJ_sha_2: "sha.png",

  diamond6_sha: "sha.png",
  diamond7_sha: "sha.png",
  diamond8_sha: "sha.png",
  diamond9_sha: "sha.png",
  diamond10_sha: "sha.png",
  diamondK_sha: "sha.png",

  // ===== 火殺也 sha.png =====
  heart4_huosha: "sha.png",
  heart7_huosha: "sha.png",
  heart10_huosha: "sha.png",
  diamond4_huosha: "sha.png",
  diamond5_huosha: "sha.png",

  // ===== 雷殺也 sha.png =====
  spade4_leisha: "sha.png",
  spade5_leisha: "sha.png",
  spade6_leisha: "sha.png",
  spade7_leisha: "sha.png",
  spade8_leisha: "sha.png",
  club5_leisha: "sha.png",
  club6_leisha: "sha.png",
  club7_leisha: "sha.png",
  club8_leisha: "sha.png",
};
  

  let fileName = imageNameMap[card.id] || `${card.id}.png`;
  const imgPath = `sgs-images/${folder}/${fileName}`;

  // 4️⃣ 武器顯示「範圍：X」
  const rangeHTML =
    card.subtype === "武器牌" && card.extra && card.extra.range
      ? `<div class="card-range">范围：${card.extra.range}</div>`
      : "";

  // 5️⃣ 坐騎顯示 +1 / -1
  let mountHTML = "";
  if (card.subtype === "坐騎牌") {
    if (card.subsubtype === "+1坐騎") {
      mountHTML = `<div class="card-mount">+1</div>`;
    } else if (card.subsubtype === "-1坐騎") {
      mountHTML = `<div class="card-mount">-1</div>`;
    }
  }

  // 6️⃣ 組卡片 HTML
  const effectText = card.effect || "（无效果）";

  const html = `
    <div class="card">
      <img src="sgs-images/card-base/card-base.png" class="card-base">

      <div class="card-suit-rank" style="color:${suitColor}">
        <div class="card-rank">${card.rank}</div>
        <div class="card-suit">${card.suit}</div>
      </div>

      <div class="card-name">${card.name}</div>

      ${rangeHTML}
      ${mountHTML}

      <div class="card-img">
        <img src="${imgPath}">
      </div>

      <!-- ⭐⭐ 效果框，加在卡片最底下（不會影響排版） ⭐⭐ -->
      <div class="card-effect-box">${effectText}</div>
    </div>
  `;

  document.getElementById("card-area").insertAdjacentHTML("beforeend", html);

const cardElement = document.getElementById("card-area").lastElementChild;
addPressEffect(cardElement);
}

// 長按邏輯（支援電腦＋手機）
function addPressEffect(cardElement) {
  const effectBox = cardElement.querySelector(".card-effect-box");
  let pressTimer = null;

  // 顯示效果框
  const showEffect = () => {
    effectBox.style.display = "block";
  };

  // 隱藏效果框
  const hideEffect = () => {
    effectBox.style.display = "none";
  };

  // 開始按住（mouse or touch）
  const startPress = () => {
    pressTimer = setTimeout(showEffect, 300); // 長按 0.3 秒才出現
  };

  // 放開（取消）
  const cancelPress = () => {
    clearTimeout(pressTimer);
    hideEffect();
  };

  // 電腦事件
  cardElement.addEventListener("mousedown", startPress);
  cardElement.addEventListener("mouseup", cancelPress);
  cardElement.addEventListener("mouseleave", cancelPress);

  // 手機 / 平板事件
  cardElement.addEventListener("touchstart", startPress);
  cardElement.addEventListener("touchend", cancelPress);
  cardElement.addEventListener("touchcancel", cancelPress);
}
const generalsRef = ref(database, "generals");
onValue(generalsRef, snapshot => {
  const data = snapshot.val();
  document.getElementById("general-area").innerHTML = "";

  Object.values(data).forEach(g => {
    renderGeneral(g);
  });
});





  

  </script>
</body>
</html>